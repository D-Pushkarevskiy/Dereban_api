<?php

require_once './config.php';
require_once './connect_db.php';
include_once './includes/helpers/data-process.php';
include_once './mailto.php';
include_once './jwt/JWT.php';

header('Access-Control-Allow-Origin: ' . ALLOW_FRONT_URL);
header('Content-Type: application/json; charset=UTF-8');
header('Access-Control-Allow-Headers: Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With');

// Ключ шифрования токенов
define('SECRET_KEY', '@p5U-xMtZbt=\vf6]xJy$q/(vJX4\y');

// Пути сохранения фотографии профиля пользователя
define('PHOTO_PATH', $_SERVER['DOCUMENT_ROOT'].'/assets/images/users_images/');

// Пути сохранения фотографий товара пользователя
define('ADS_IMAGES_PATH', $_SERVER['DOCUMENT_ROOT'].'/assets/images/users_images/showcase_photos/');

// Base64 logo
define('LOGO_BASE64', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAD6CAYAAABXq7VOAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNmlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjarY6xSsNQFEDPi6LiUCsEcXB4kygotupgxqQtRRCs1SHJ1qShSmkSXl7VfoSjWwcXd7/AyVFwUPwC/0Bx6uAQIYODCJ7p3MPlcsGo2HWnYZRhEGvVbjrS9Xw5+8QMUwDQCbPUbrUOAOIkjvjB5ysC4HnTrjsN/sZ8mCoNTIDtbpSFICpA/0KnGsQYMIN+qkHcAaY6addAPAClXu4vQCnI/Q0oKdfzQXwAZs/1fDDmADPIfQUwdXSpAWpJOlJnvVMtq5ZlSbubBJE8HmU6GmRyPw4TlSaqo6MukP8HwGK+2G46cq1qWXvr/DOu58vc3o8QgFh6LFpBOFTn3yqMnd/n4sZ4GQ5vYXpStN0ruNmAheuirVahvAX34y/Axk/96FpPYgAAQqppVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTMyIDc5LjE1OTI4NCwgMjAxNi8wNC8xOS0xMzoxMzo0MCAgICAgICAgIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICAgICAgICAgICB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgICAgICAgICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICAgICAgICAgIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8eG1wOkNyZWF0b3JUb29sPkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1LjUgKFdpbmRvd3MpPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgICAgIDx4bXA6Q3JlYXRlRGF0ZT4yMDE4LTA2LTExVDExOjE1OjM5KzAzOjAwPC94bXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxOC0wNi0xNVQwOTowMzo1MCswMzowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTgtMDYtMTVUMDk6MDM6NTArMDM6MDA8L3htcDpNb2RpZnlEYXRlPgogICAgICAgICA8cGhvdG9zaG9wOkNvbG9yTW9kZT4zPC9waG90b3Nob3A6Q29sb3JNb2RlPgogICAgICAgICA8cGhvdG9zaG9wOklDQ1Byb2ZpbGU+QWRvYmUgUkdCICgxOTk4KTwvcGhvdG9zaG9wOklDQ1Byb2ZpbGU+CiAgICAgICAgIDxwaG90b3Nob3A6VGV4dExheWVycz4KICAgICAgICAgICAgPHJkZjpCYWc+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8cGhvdG9zaG9wOkxheWVyTmFtZT5ERVJFQkFOPC9waG90b3Nob3A6TGF5ZXJOYW1lPgogICAgICAgICAgICAgICAgICA8cGhvdG9zaG9wOkxheWVyVGV4dD5ERVJFQkFOPC9waG90b3Nob3A6TGF5ZXJUZXh0PgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgPC9yZGY6QmFnPgogICAgICAgICA8L3Bob3Rvc2hvcDpUZXh0TGF5ZXJzPgogICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3BuZzwvZGM6Zm9ybWF0PgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjA4NmZkOGU2LTc5ZmYtYzY0ZC1hNzc3LTgyOTYwNmU5NDMxOTwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmRiY2Y5NDM0LTcwNjEtMTFlOC1hYTBlLTgwNzFhOTI0NmVjYTwveG1wTU06RG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD54bXAuZGlkOjc3N2VhMzBkLTdlN2YtYmM0NS05YjI0LWJmMzY5ZGZhNDJhNDwveG1wTU06T3JpZ2luYWxEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06SGlzdG9yeT4KICAgICAgICAgICAgPHJkZjpTZXE+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9uPmNyZWF0ZWQ8L3N0RXZ0OmFjdGlvbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0Omluc3RhbmNlSUQ+eG1wLmlpZDo3NzdlYTMwZC03ZTdmLWJjNDUtOWIyNC1iZjM2OWRmYTQyYTQ8L3N0RXZ0Omluc3RhbmNlSUQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDp3aGVuPjIwMTgtMDYtMTFUMTE6MTU6MzkrMDM6MDA8L3N0RXZ0OndoZW4+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpzb2Z0d2FyZUFnZW50PkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1LjUgKFdpbmRvd3MpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+c2F2ZWQ8L3N0RXZ0OmFjdGlvbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0Omluc3RhbmNlSUQ+eG1wLmlpZDoyYjhhM2M0NC02MjdjLTVhNDEtOTBlMS04MGM5ZjViNDYyYmU8L3N0RXZ0Omluc3RhbmNlSUQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDp3aGVuPjIwMTgtMDYtMTRUMTY6NTA6MzErMDM6MDA8L3N0RXZ0OndoZW4+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpzb2Z0d2FyZUFnZW50PkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1LjUgKFdpbmRvd3MpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICAgICA8c3RFdnQ6Y2hhbmdlZD4vPC9zdEV2dDpjaGFuZ2VkPgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+c2F2ZWQ8L3N0RXZ0OmFjdGlvbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0Omluc3RhbmNlSUQ+eG1wLmlpZDoxMzAxMGExOC1lMTVjLTkzNDAtOTlmMy03M2RmYjQ2YTdiZjU8L3N0RXZ0Omluc3RhbmNlSUQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDp3aGVuPjIwMTgtMDYtMTVUMDk6MDM6NTArMDM6MDA8L3N0RXZ0OndoZW4+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpzb2Z0d2FyZUFnZW50PkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1LjUgKFdpbmRvd3MpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICAgICA8c3RFdnQ6Y2hhbmdlZD4vPC9zdEV2dDpjaGFuZ2VkPgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+Y29udmVydGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpwYXJhbWV0ZXJzPmZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmc8L3N0RXZ0OnBhcmFtZXRlcnM+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5kZXJpdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpwYXJhbWV0ZXJzPmNvbnZlcnRlZCBmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nPC9zdEV2dDpwYXJhbWV0ZXJzPgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+c2F2ZWQ8L3N0RXZ0OmFjdGlvbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0Omluc3RhbmNlSUQ+eG1wLmlpZDowODZmZDhlNi03OWZmLWM2NGQtYTc3Ny04Mjk2MDZlOTQzMTk8L3N0RXZ0Omluc3RhbmNlSUQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDp3aGVuPjIwMTgtMDYtMTVUMDk6MDM6NTArMDM6MDA8L3N0RXZ0OndoZW4+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpzb2Z0d2FyZUFnZW50PkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1LjUgKFdpbmRvd3MpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICAgICA8c3RFdnQ6Y2hhbmdlZD4vPC9zdEV2dDpjaGFuZ2VkPgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgPC9yZGY6U2VxPgogICAgICAgICA8L3htcE1NOkhpc3Rvcnk+CiAgICAgICAgIDx4bXBNTTpEZXJpdmVkRnJvbSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgIDxzdFJlZjppbnN0YW5jZUlEPnhtcC5paWQ6MTMwMTBhMTgtZTE1Yy05MzQwLTk5ZjMtNzNkZmI0NmE3YmY1PC9zdFJlZjppbnN0YW5jZUlEPgogICAgICAgICAgICA8c3RSZWY6ZG9jdW1lbnRJRD5hZG9iZTpkb2NpZDpwaG90b3Nob3A6ODJhZDI1NTItNzA2MC0xMWU4LTkwMmYtODcwNjZkOTEzYzA5PC9zdFJlZjpkb2N1bWVudElEPgogICAgICAgICAgICA8c3RSZWY6b3JpZ2luYWxEb2N1bWVudElEPnhtcC5kaWQ6Nzc3ZWEzMGQtN2U3Zi1iYzQ1LTliMjQtYmYzNjlkZmE0MmE0PC9zdFJlZjpvcmlnaW5hbERvY3VtZW50SUQ+CiAgICAgICAgIDwveG1wTU06RGVyaXZlZEZyb20+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOlhSZXNvbHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpYUmVzb2x1dGlvbj4KICAgICAgICAgPHRpZmY6WVJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOllSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpSZXNvbHV0aW9uVW5pdD4yPC90aWZmOlJlc29sdXRpb25Vbml0PgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjY1NTM1PC9leGlmOkNvbG9yU3BhY2U+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj41MDA8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MjUwPC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz6t1MIpAAAAIGNIUk0AAHolAACAgwAA+f8AAIDoAABSCAABFVgAADqXAAAXb9daH5AAACN/SURBVHja7N19nFx1Ye/xz/IYpYApCtQWq8GxSE15WGBe5VYrJVrv6MwoNqCwc7vjq00W+8JrKSRRq4heIQFEr31godZZ7w4iRKmzp51yNRZ8uLRLSCQ3FpSFoKalgApCLhKQZO8f5zdmTPOwu3PO7Dx83q/Xvhbj7m9+52HP9/zO+T0MTE9PI0mSutsB7gJJkgx0SZJkoEuSJANdkiQZ6JIkGeiSJMlAlyRJBrokSTLQJUky0CVJkoEuSZIMdEmSZKBLkmSgS5IkA12SJBnokiTJQJckyUCXJEkGuiRJStNB7gJ1q4GBAXdCkB8afxFwevg6FXgZ8GvA0cCB4cd2AI8BW8PXRmA9cFdULT3pXoxNT0+7E9Sd10RPXhnoXRviRwNvB94GnNXCDfrzwB3AF4G/i6qlRw10yUCXDPT0g/xk4L8D5wOHJFz8c8DngE9G1dImA10y0CUDPfkgPxFYDeTb9JERsCqqlu410CUDXTLQWw/yBcDlwMW0v9/L88C1wGVRtbTdQJcMdMlAn1uYLwZuAU6Y56p8Bzg3qpY2G+hSZ3LYmtS5Yf5O4K4OCHNCHe7KD42f75GRDHRJMw/zFcSd0xZ0ULUWADeGukky0CXtJ8w/Bqzp4CquyQ+NX+mRkgx0SXsP80uB93dBVVeFukrq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');

use \Firebase\JWT\JWT;

/** 
 * Get header Authorization
 * */
function getAuthorizationHeader()
{
    $headers = null;
    if (isset($_SERVER['Authorization'])) {
        $headers = trim($_SERVER["Authorization"]);
    } else if (isset($_SERVER['HTTP_AUTHORIZATION'])) { // Nginx or fast CGI
        $headers = trim($_SERVER["HTTP_AUTHORIZATION"]);
    } elseif (function_exists('apache_request_headers')) {
        $requestHeaders = apache_request_headers();
        // Server-side fix for bug in old Android versions (a nice side-effect of this fix means we don't care about capitalization for Authorization)
        $requestHeaders = array_combine(array_map('ucwords', array_keys($requestHeaders)), array_values($requestHeaders));
        // print_r($requestHeaders);
        if (isset($requestHeaders['Authorization'])) {
            $headers = trim($requestHeaders['Authorization']);
        }
    }
    return $headers;
}
/**
 * get access token from header
 * */
function getBearerToken()
{
    $headers = getAuthorizationHeader();
    // HEADER: Get the access token from the header
    if (!empty($headers)) {
        if (preg_match('/Bearer\s(\S+)/', $headers, $matches)) {
            return $matches[1];
        }
    }
    return null;
}

// Роутинг по функциям
if (isset($_GET['func'])) {
    switch ($_GET['func']) {
        case 'auth':
            Auth();
            break;
        case 'refresh_password_request':
            RefreshPasswordRequest();
            break;
        case 'refresh_password':
            RefreshPassword();
            break;
        case 'conf_register':
            Conf_register();
            break;
        case 'mailto':
            Mailto($param1, $param2, $param3);
            break;
        case 'get_user_name':
            GetUserName();
            break;
        case 'get_title_for_user_ads_component':
            GetTitleForUserAdsComp();
            break;
        case 'get_user_data':
            GetUserData();
            break;
        case 'get_user_rating':
            GetUserRating();
            break;
        case 'add_user_info':
            AddUserInfo();
            break;
        case 'get_user_info':
            GetUserInfo();
            break;
        case 'get_showcase_options':
            GetShowcaseOptions();
            break;
        case 'set_user_photo':
            SetUserPhoto();
            break;
        case 'remove_auth_token':
            RemoveAuthToken();
            break;
        case 'save_showcase_photo':
            SaveShowcasePhoto();
            break;
        case 'save_showcase':
            SaveShowcase();
            break;
        case 'get_show_cases':
            GetShowCases();
            break;
        case 'showcase_change_rating':
            ShowCaseChangeRating();
            break;
        case 'showcase_get_rating':
            ShowCaseGetRating();
            break;
        case 'get_active_rating':
            GetActiveRating();
            break;
        case 'showcase_toggle_favorite':
            ShowCaseToggleFavorite();
            break;
        case 'get_active_favorite':
            GetActiveFavorite();
            break;
        case 'is_owner':
            IsOwner();
            break;
        case 'get_case':
            GetCase();
            break;
        case 'showcase_toggle_active':
            ShowCaseToggleActive();
            break;
        case 'delete_showcase':
            DeleteShowCase();
            break;
    }
}

// Ответ фронтенду
function result_text($code, $text, $isAuth = NULL)
{
    echo json_encode([
        'code' => $code,
        'text' => $text,
        'isAuth' => $isAuth
    ]);
    return false;
}

function result_user_info($photo, $name, $surname, $phone, $phone2, $area, $telegram, $vk, $facebook, $instagram)
{
    echo json_encode([
        'photo' => $photo,
        'name' => $name,
        'surname' => $surname,
        'phone' => $phone,
        'phone2' => $phone2,
        'area' => $area,
        'telegram' => $telegram,
        'vk' => $vk,
        'facebook' => $facebook,
        'instagram' => $instagram
    ]);
    return false;
}

function Auth()
{

    global $db;

    // Проверка на установление переменной значением и на ее пустоту (login, password)
    if (isset($_GET['login']) && $_GET['login'] != '' && isset($_GET['password']) && $_GET['password'] != '') {

        $user_login = $_GET['login'];
        $user_password = $_GET['password'];

        // Запрос на поле пароля имейл которого совпадает с введенным пользователем
        $sql_check_data = 'select password from `user` where email=' . QPrepStr($user_login);
        $query = $db->Execute($sql_check_data);

        // Авторизация, иначе регистрация
        if ($query && ($query->RecordCount() > 0)) {

            $sql_check_token = 'select '
                . 'ut.regToken '
                . 'from `user_tokens` ut '
                . 'inner join `user` u on ut.user_id=u.id '
                . 'where u.email=' . QPrepStr($user_login);
            $query_check_token = $db->Execute($sql_check_token);
            // Вход в существующий аккаунт
            if ($user_password != $query->Fields('password')) {
                // Ошибка ввода пароля
                // Проверка кол-ва неправильных вводов пароля
                $sql_get_login_attempt = $db->Execute("select login_attempts from `user` where email=" . QPrepStr($user_login));
                if ($sql_get_login_attempt && $sql_get_login_attempt->Fields('login_attempts') >= 5) {
                    result_text(4, 'LOGIN_DATA_INCORRECT_ATTEMPTS');
                } else {
                    $sql_add_login_attempt = $db->Execute('update `user` set login_attempts=login_attempts + 1 where email=' . QPrepStr($user_login));
                    result_text(3, 'LOGIN_DATA_INCORRECT');
                }
            } else {
                if ($query_check_token && ($query_check_token->RecordCount() > 0)) {
                    if ($query_check_token->Fields('regToken') != null) {
                        result_text(1, 'ACCOUNT_NOT_CONFIRMED');
                    } else {
                        // Создание токена авторизированного пользователя
                        $authToken = array(
                            'user' => $user_login,
                            'date' => gmmktime()
                        );

                        $jwt = JWT::encode($authToken, SECRET_KEY);

                        // Выбираем id пользователя из таблицы user
                        $sql_get_user_id = $db->Execute("select id from `user` where email=" . QPrepStr($user_login));

                        if ($sql_get_user_id) {
                            // Проверка на существование authToken-а
                            $sql_auth_token = $db->Execute("select authToken from `user_tokens` where id=" . $sql_get_user_id->Fields('id'));
                            if ($sql_auth_token && ($sql_auth_token->Fields('authToken') != NULL)) {
                                // Успешная авторизация
                                result_text(0, $sql_auth_token->Fields('authToken'));
                                $sql_add_login_attempt = $db->Execute('update `user` set login_attempts=0 where email=' . QPrepStr($user_login));
                            } else {
                                // Занесение токена в базу данных
                                $sql_add_auth_token = 'update `user_tokens` set authToken=' . QPrepStr($jwt) . ' where user_id=' . $sql_get_user_id->Fields('id');
                                $query_add_auth_token = $db->Execute($sql_add_auth_token);

                                if ($query_add_auth_token) {

                                    $sql_check_date_login = $db->Execute('select last_login_date from `user` where email=' . QPrepStr($user_login));

                                    if ($sql_check_date_login && ($sql_check_date_login->Fields('last_login_date') != NULL)) {
                                        // Успешная авторизация
                                        result_text(0, $jwt);
                                    } else {
                                        // Успешная авторизация в первый раз
                                        result_text(0, $jwt, false);
                                    }

                                    $sql_add_date_login = $db->Execute('update `user` set last_login_date=' . intval(gmmktime()) . ' where email=' . QPrepStr($user_login));
                                    $sql_add_login_attempt = $db->Execute('update `user` set login_attempts=0 where email=' . QPrepStr($user_login));
                                } else {
                                    result_text(1, 'INTERNAL_ERROR 18');
                                }
                            }
                        } else {
                            result_text(1, 'INTERNAL_ERROR 17');
                        }
                    }
                } else {
                    result_text(1, 'INTERNAL_ERROR 16');
                }
            }
        } else {

            $regToken = array(
                'user' => $user_login,
                'date' => gmmktime()
            );
            $jwt = JWT::encode($regToken, SECRET_KEY);

            $url = 'http://localhost:4200/confirm-registration/' . $jwt;

            // Заносим данные в базу
            $sql_add_user_data = $db->Execute("insert into `user`(email, password) values (" . QPrepStr($user_login) . "," . QPrepStr($user_password) . ")");

            if ($sql_add_user_data) {
                // Выбираем id пользователя из таблицы user
                $sql_get_user_id = $db->Execute("select id from `user` where email=" . QPrepStr($user_login));

                if ($sql_get_user_id) {
                    // Добавляем user_id из таблицы user поля id
                    $sql_set_user_id = $db->Execute("insert into `user_tokens` (user_id, regToken) values(" . $sql_get_user_id->Fields('id') . ", " . QPrepStr($jwt) . ")");
                    // Добавляем информацию о пользователе в таблицу user_contacts
                    $login = explode('@', $user_login)[0];
                    $sql_add_user_contacts_data = $db->Execute("insert into `user_contacts`(user_id,name) values (" . $sql_get_user_id->Fields('id') . "," . QPrepStr($login) . ")");
                    if ($sql_set_user_id && $sql_add_user_contacts_data) {
                        // Отправляем e-mail
                        $subject = "Подтверждение регистрации на сайте 'Dereban.ua'";
                        $content = '<div style="text-align: center;font-size: 16px;padding: 30px 20px;border: 1px solid #d4ddf9;border-radius: 10px;">
                            <div style="margin-bottom: 30px;">
                            <a href="dereban.ua">
                            <img src="' . LOGO_BASE64 . '" style="width: 200px;">
                            </a>
                            </div>
                            <div>
                            <h3>Подтверждение регистрации</h3>
                            <hr>
                            </div>
                            <div style="margin-bottom: 30px;">
                            Для подтверждения регистрации на сайте <a href="dereban.ua">Dereban.ua</a> перейдите по ссылке:
                            </div>
                            <div style="margin-bottom: 20px;">
                            <a href=' . $url . ' target="_blank" style="color: #f7f7f7;text-decoration: none;padding: 15px;background-color: #445ba7;border-radius: 5px;font-size: 14px;">
                            Подтвердить регистрацию
                            </a>
                            </div>
                            </div>';
                        if (Mailto(PrepStr($user_login), $subject, $content)) {
                            // Отправляем результат на фронтенд
                            result_text(2, 'ON_EMAIL_SENDED_CONFIRM');
                        } else {
                            result_text(1, 'INTERNAL_ERROR 15');
                        }
                    } else {
                        result_text(1, 'INTERNAL_ERROR 14');
                    }
                } else {
                    result_text(1, 'INTERNAL_ERROR 13');
                }
            } else {
                result_text(1, 'INTERNAL_ERROR 12');
            }
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 11');
    }
}

function RefreshPasswordRequest()
{
    global $db;

    if (isset($_GET['email']) && $_GET['email'] != '') {
        $user_email = $_GET['email'];

        $sql_check_user_email = $db->Execute("select email from `user` where email=" . QPrepStr($user_email));

        if ($sql_check_user_email && ($sql_check_user_email->RecordCount() > 0)) {
            $url = 'http://localhost:4200/refresh-password/' . gmmktime();
            $sql_get_user_id = $db->Execute('select id from `user` where email=' . QPrepStr($user_email));
            if ($sql_get_user_id && ($sql_get_user_id->RecordCount() > 0)) {
                $sql_add_passToken = $db->Execute('update `user_tokens` set passToken=' . intval(gmmktime()) . ' where user_id=' . $sql_get_user_id->Fields('id'));
                if ($sql_add_passToken) {
                    $subject = "Сброс пароля на сайте 'Dereban.ua'";
                    $content = '<div style="text-align: center;font-size: 16px;padding: 30px 20px;border: 1px solid #d4ddf9;border-radius: 10px;">
                            <div style="margin-bottom: 30px;">
                            <a href="dereban.ua">
                            <img src="' . LOGO_BASE64 . '" style="width: 200px;">
                            </a>
                            </div>
                            <div>
                            <h3>Сброс пароля</h3>
                            <hr>
                            </div>
                            <div style="margin-bottom: 30px;">
                            Для сброса пароля на сайте <a href="dereban.ua">Dereban.ua</a>, передите по ссылке:
                            </div>
                            <div style="margin-bottom: 20px;">
                            <a href=' . $url . ' target="_blank" style="color: #f7f7f7;text-decoration: none;padding: 15px;background-color: #445ba7;border-radius: 5px;font-size: 14px;">
                            Сбросить пароль
                            </a>
                            </div>
                            </div>';
                    if (Mailto($user_email, $subject, $content)) {
                        result_text(2, 'ON_EMAIL_SENDED_PASS_RESET');
                    } else {
                        result_text(1, 'INTERNAL_ERROR 21');
                    }
                } else {
                    result_text(1, 'INTERNAL_ERROR 22');
                }
            } else {
                result_text(1, 'INTERNAL_ERROR 23');
            }
        } else {
            result_text(1, 'CURRENT_EMAIL_NOT_REGISTERED');
        }
    }
}

function RefreshPassword()
{
    global $db;

    if (isset($_GET['current']) && $_GET['current'] != '' && isset($_GET['new']) && $_GET['new'] != '' && $_GET['token'] != '') {

        $current_password = $_GET['current'];
        $new_password = $_GET['new'];
        $token = $_GET['token'];

        $sql_check_pass = 'select '
            . 'u.password '
            . 'from `user` u '
            . 'inner join `user_tokens` ut on u.id=ut.user_id '
            . 'where ut.passToken=' . QPrepStr($token);
        $query = $db->Execute($sql_check_pass);

        $sql_get_user_id = $db->Execute('select user_id from `user_tokens` where passToken=' . QPrepStr($token));

        if ($query && ($query->RecordCount() > 0)) {
            if ($current_password != $query->Fields('password')) {
                // Ошибка ввода пароля
                result_text(3, 'CHECK_PASSWORD');
            } else {
                // Успешная смена пароля
                $sql_delete_passToken = 'update `user_tokens` set passToken=null where passToken=' . QPrepStr($token);
                $query = $db->Execute($sql_delete_passToken);
                if ($query) {
                    $sql_update_password = 'update `user` set password=' . QPrepStr($new_password) . ' where id=' . intval($sql_get_user_id->Fields('user_id'));
                    $query = $db->Execute($sql_update_password);
                    if ($query) {
                        result_text(0, "RESET_PASSWORD_SUCCESS");
                    } else {
                        result_text(1, 'INTERNAL_ERROR 31');
                    }
                } else {
                    result_text(1, 'INTERNAL_ERROR 32');
                }
            }
        } else {
            result_text(2, 'PASSWORD_ALREADY_RESET');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 33');
    }
}

function Conf_register()
{

    global $db;

    // Проверка на установление переменной значением и на ее пустоту (password)

    if (isset($_GET['password']) && $_GET['password'] != '' && $_GET['regToken'] != '') {

        $user_password = $_GET['password'];
        $regToken = $_GET['regToken'];

        $sql_check_pass = 'select '
            . 'u.password '
            . 'from `user` u '
            . 'inner join `user_tokens` ut on u.id=ut.user_id '
            . 'where ut.regToken=' . QPrepStr($regToken);
        $query = $db->Execute($sql_check_pass);

        if ($query && ($query->RecordCount() > 0)) {
            if ($user_password != $query->Fields('password')) {
                // Ошибка ввода пароля
                result_text(3, 'CHECK_PASSWORD');
            } else {
                // Успешная регистрация
                $sql_delete_regToken = 'update `user_tokens` set regToken=null where regToken=' . QPrepStr($regToken);
                $query = $db->Execute($sql_delete_regToken);
                result_text(0, "YEPI_REGISTERED_SUCCESS");
            }
        } else {
            result_text(1, 'ACCOUNT_ALREADY_CONFIRMED');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 41');
    }
}

function SqlGetUserId()
{
    global $db;
    $authToken = getBearerToken();

    if ($authToken) {
        $sql_get_user_id = $db->Execute('select user_id from `user_tokens` where authToken=' . QPrepStr($authToken));
        if ($sql_get_user_id && ($sql_get_user_id->Fields('user_id') != '')) {
            return $sql_get_user_id->Fields('user_id');
        } else {
            return false;
        }
    } else {
        return false;
    }
}

function GetUserData()
{
    global $db;
    $authToken = getBearerToken();

    if ($authToken) {
        $sql_get_user_data = $db->Execute('select '
            . 'uc.user_id, '
            . 'uc.name, '
            . 'uc.photo, '
            . 'uc.area '
            . 'from `user_contacts` uc '
            . 'inner join `user_tokens` ut on uc.user_id=ut.user_id '
            . 'where ut.authToken=' . QPrepStr($authToken));

            $sql_get_showcases_limit = $db->Execute('select case_limit from `user` where id=' . SqlGetUserId());
            $sql_get_showcases_count = $db->Execute('select count(*) from `user_showcase` where user_id=' . SqlGetUserId());

        if ($sql_get_user_data && ($sql_get_user_data->RecordCount() > 0) && $sql_get_showcases_count && ($sql_get_showcases_count->RecordCount() > 0) && $sql_get_showcases_limit && $sql_get_showcases_limit->RecordCount() > 0) {
            result_text(0, [
                'id' => $sql_get_user_data->Fields('user_id'),
                'name' => $sql_get_user_data->Fields('name'),
                'photo' => $sql_get_user_data->Fields('photo'),
                'area' => $sql_get_user_data->Fields('area'),
                'limit' => $sql_get_showcases_limit->Fields('case_limit'),
                'showcase_count' => $sql_get_showcases_count->Fields('count(*)')
            ]);
        } else {
            result_text(1, 'INTERNAL_ERROR 51');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 52');
    }
}

function GetTitleForUserAdsComp()
{
    global $db;

    if (isset($_GET['id']) && $_GET['id'] != '') {

        $id = $_GET['id'];

        if (SqlGetUserId() === $id) {
            result_text(2, 'MAIN.MY_SHOWCASES');
        } else {
            $sql_get_user_name_surname = $db->Execute('select name, surname from `user_contacts` where user_id=' . $id);

            if ($sql_get_user_name_surname && ($sql_get_user_name_surname->RecordCount() > 0)) {
                result_text(0, ['MAIN.USERS_SHOWCASES', ' - ' . $sql_get_user_name_surname->Fields('name') . ' ' . $sql_get_user_name_surname->Fields('surname')]);
            } else {
                result_text(1, 'INTERNAL_ERROR 61');
            }
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 62');
    }
}

function GetUserRating()
{
    global $db;
    $authToken = getBearerToken();

    if ((isset($_GET['case_id']) && $_GET['case_id'] != '') || $authToken) {
        if (isset($_GET['case_id']) && $_GET['case_id'] != '') {
            $case_id = $_GET['case_id'];
            $sql_get_user_id = $db->Execute('select user_id from `user_showcase` where id=' . intval($case_id));
        } else if ($authToken) {
            $sql_get_user_id = $db->Execute('select user_id from `user_tokens` where authToken=' . QPrepStr($authToken));
        }
        if ($sql_get_user_id) {

            $sql_get_user_ads_id = $db->Execute('select id from `user_showcase` where user_id=' . $sql_get_user_id->Fields('user_id'));
            if ($sql_get_user_ads_id) {
                $rating = [];

                while (!$sql_get_user_ads_id->EOF) {
                    $rating[] = $sql_get_user_ads_id->Fields('id');
                    $sql_get_user_ads_id->MoveNext();
                }
                if ($sql_get_user_ads_id && $rating) {
                    $sql_get_users_rating = $db->Execute('select sum(rating_value) as `sum` from `case_rating` where case_id in (' . implode(',', $rating) . ')');
                    if ($sql_get_users_rating) {
                        result_text(0, $sql_get_users_rating->Fields('sum'));
                    } else {
                        result_text(1, 'INTERNAL_ERROR 71');
                    }
                } else {
                    result_text(0, 0);
                }
            } else {
                result_text(1, 'INTERNAL_ERROR 72');
            }
        } else {
            result_text(1, 'INTERNAL_ERROR 73');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 74');
    }
}

function AddUserInfo()
{
    global $db;

    $request_body = file_get_contents('php://input');
    $data = json_decode($request_body, true);

    if (SqlGetUserId()) {
        if (isset($data['user']) && ($user = $data['user']) && isset($data['contacts']) && ($contacts = $data['contacts']) && isset($data['social']) && ($social = $data['social'])) {

            if (empty($contacts['phone2']) || $contacts['phone2'] === '' || $contacts['phone2'] === null) {
                $phone2 = 'null';
            } else {
                $phone2 = intval($contacts['phone2']);
            }

            $upd = [];
            $upd[] = ' name=' . QPrepStr($user['name']);
            $upd[] = ' surname=' . QPrepStr($user['surname']);
            $upd[] = ' phone=' . intval($contacts['phone']);
            $upd[] = ' phone2=' . $phone2;
            $upd[] = ' area=' . QPrepStr($contacts['area']);
            $upd[] = ' telegram=' . QPrepStr($social['telegram']);
            $upd[] = ' vk=' . QPrepStr($social['vk']);
            $upd[] = ' facebook=' . QPrepStr($social['facebook']);
            $upd[] = ' instagram=' . QPrepStr($social['instagram']);

            $sql_add_user_info = $db->Execute('update `user_contacts` set '
                . implode(',', $upd)
                . 'where user_id=' . SqlGetUserId());

            if ($sql_add_user_info) {
                result_text(0, 'DATA_SAVED');
            } else {
                result_text(1, 'INTERNAL_ERROR 81');
            }
        } else {
            result_text(1, 'INTERNAL_ERROR 82');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 83');
    }
}

function GetUserInfo()
{
    global $db;

    if (SqlGetUserId()) {
        $sql_select_user_info = $db->Execute('select 
        photo,
        name, 
        surname, 
        phone, 
        phone2, 
        area, 
        telegram, 
        vk, 
        facebook, 
        instagram 
        from `user_contacts` where user_id=' . SqlGetUserId());

        if ($sql_select_user_info && ($sql_select_user_info->RecordCount() > 0)) {
            result_user_info(
                $sql_select_user_info->Fields('photo'),
                $sql_select_user_info->Fields('name'),
                $sql_select_user_info->Fields('surname'),
                $sql_select_user_info->Fields('phone'),
                $sql_select_user_info->Fields('phone2'),
                $sql_select_user_info->Fields('area'),
                $sql_select_user_info->Fields('telegram'),
                $sql_select_user_info->Fields('vk'),
                $sql_select_user_info->Fields('facebook'),
                $sql_select_user_info->Fields('instagram')
            );
        } else {
            result_text(1, 'INTERNAL_ERROR 84');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 85');
    }
}

function GetShowcaseOptions()
{
    global $db;

    $sql_get_showcase_options = $db->Execute('select * from `case_options`');

    if ($sql_get_showcase_options && $sql_get_showcase_options->RecordCount() > 0) {
        result_text(0, [
            'types' => $sql_get_showcase_options->Fields('types'),
            'full_types' => $sql_get_showcase_options->Fields('full_types'),
            'parts' => $sql_get_showcase_options->Fields('parts'),
            'states' => $sql_get_showcase_options->Fields('states'),
            'wheel_sizes' => $sql_get_showcase_options->Fields('wheel_sizes'),
            'bike_types' => $sql_get_showcase_options->Fields('bike_types'),
            'bike_directions' => $sql_get_showcase_options->Fields('bike_directions')
            ]);
    } else {
        result_text(1, 'INTERNAL_ERROR 86');
    }
}

function SetUserPhoto()
{
    global $db;

    if (isset($_FILES['photo']) && $_FILES['photo'] != '') {

        if (SqlGetUserId()) {
            include_once './user_photo.php';
        } else {
            result_text(1, 'INTERNAL_ERROR 91');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 92');
    }
}

function RemoveAuthToken()
{
    global $db;
    $authToken = getBearerToken();

    if ($authToken) {
        $sql_remove_token = $db->Execute('update `user_tokens` set authToken="" where authToken=' . QPrepStr($authToken));

        if ($sql_remove_token) {
            result_text(0, 'JWT_DELETED');
        } else {
            result_text(1, 'INTERNAL_ERROR 101');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 102');
    }
}

function SaveShowcasePhoto()
{
    global $db;

    if (isset($_FILES['photo']) && $_FILES['photo'] !== '') {
        if (SqlGetUserId()) {
            include_once './showcase_photo.php';
        } else {
            result_text(1, 'INTERNAL_ERROR 111');
        }
    } else {
        result_text(0, '');
    }
}

function SaveShowcase()
{
    global $db;

    $request_body = file_get_contents('php://input');
    $data = json_decode($request_body, true);

    if (SqlGetUserId()) {
        if (isset($data['main']) && ($main = $data['main']) && isset($data['options']) && ($options = $data['options']) && isset($data['description']) && ($description = $data['description']) && isset($data['additionalPhotos']) && ($additionalPhotos = $data['additionalPhotos'])) {

            $filePath = $_GET['file_path'];

            $upd = [];
            $upd[] = ' ' . QPrepStr($main['name']);
            $upd[] = ' ' . intval($main['price']);
            $upd[] = ' ' . intval($options['type']);
            $upd[] = ' ' . intval($options['fullType']);
            $upd[] = ' ' . intval($options['detailType']);
            $upd[] = ' ' . intval($options['state']);
            $upd[] = ' ' . intval($options['wheelSize']);
            $upd[] = ' ' . intval($options['veloType']);
            $upd[] = ' ' . intval($options['direction']);
            $upd[] = ' ' . QPrepStr($description['description']);
            $upd[] = ' ' . QPrepStr($additionalPhotos['addPhotosLink']);

            if (SqlGetUserId()) {
                if ($_GET['edit'] && $_GET['edit'] == true) {
                    $sql_record_old_price = $db->Execute('update `user_showcase` set `old_price`=`price` where id=' . $_GET['id']);
                    if ($sql_record_old_price) {
                        $sql_update_showcase = $db->Execute('update `user_showcase` set '
                            . 'update_time=' . gmmktime() . ','
                            . 'photo_url=' . QPrepStr($filePath) . ','
                            . 'case_name=' . QPrepStr($main['name']) . ','
                            . 'price=' . intval($main['price']) . ','
                            . 'type=' . intval($options['type']) . ','
                            . 'full_type=' . intval($options['fullType']) . ','
                            . 'detail_type=' . intval($options['detailType']) . ','
                            . 'state=' . intval($options['state']) . ','
                            . 'wheel_size=' . intval($options['wheelSize']) . ','
                            . 'velo_type=' . intval($options['veloType']) . ','
                            . 'direction=' . intval($options['direction']) . ','
                            . 'description=' . QPrepStr($description['description']) . ','
                            . 'additionalPhotos=' . QPrepStr($additionalPhotos['addPhotosLink'])
                            . ' where id=' . $_GET['id']);
                        if ($sql_update_showcase) {
                            result_text(0, 'DATA_SAVED');
                        } else {
                            result_text(1, 'INTERNAL_ERROR 121');
                        }
                    } else {
                        result_text(1, 'INTERNAL_ERROR 122');
                    }
                } else {
                    $sql_add_showcase = $db->Execute('insert into `user_showcase` (user_id, adding_time, update_time, photo_url, case_name, price, type, full_type, detail_type, state, wheel_size, velo_type, direction, description, additionalPhotos) values ('
                        . SqlGetUserId() . ','
                        . gmmktime() . ','
                        . gmmktime() . ','
                        . QPrepStr($filePath) . ','
                        . implode(',', $upd)
                        . ')');
                    if ($sql_add_showcase) {
                        result_text(0, 'SHOWCASE_ADDED');
                    } else {
                        result_text(1, 'INTERNAL_ERROR 123');
                    }
                }
            } else {
                result_text(1, 'INTERNAL_ERROR 124');
            }
        } else {
            result_text(1, 'INTERNAL_ERROR 125');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 126');
    }
}

function GetShowCases()
{
    global $db;

    $case_id = '';
    $condition = '';

    if (isset($_GET['id']) && $_GET['id'] != '') {
        $condition = 'where us.id=' . intval($_GET['id']);
    } else if (isset($_GET['user_id']) && $_GET['user_id'] != '') {
        $condition = 'where us.user_id=' . intval($_GET['user_id']) . ' order by adding_time desc';
    } else if (isset($_GET['favorites']) && $_GET['favorites']) {
        $sql_get_favorite_case_id = $db->Execute('select case_id from `case_favorite` where user_id=' . SqlGetUserId());
        $case_ids = [];
        if ($sql_get_favorite_case_id) {
            while (!$sql_get_favorite_case_id->EOF) {
                $case_ids[] = $sql_get_favorite_case_id->Fields('case_id');
                $sql_get_favorite_case_id->MoveNext();
            }
            $condition = 'where us.id in (' . implode(',', $case_ids) . ') order by adding_time desc';
        } else {
            result_text(1, []);
            return;
        }
    } else {
        $condition = 'order by adding_time desc';
    }

    $sql_get_show_cases = $db->Execute('select '
        . 'us.id, '
        . 'us.user_id, '
        . 'us.adding_time, '
        . 'us.update_time, '
        . 'us.case_name, '
        . 'us.photo_url, '
        . 'us.price, '
        . 'us.old_price, '
        . 'us.type, '
        . 'us.full_type, '
        . 'us.detail_type, '
        . 'us.state, '
        . 'us.wheel_size, '
        . 'us.velo_type, '
        . 'us.direction, '
        . 'us.description, '
        . 'us.additionalPhotos, '
        . 'us.active, '
        . 'uc.name, '
        . 'uc.photo, '
        . 'uc.surname, '
        . 'uc.area, '
        . 'uc.telegram, '
        . 'uc.phone, '
        . 'uc.phone2, '
        . 'uc.vk, '
        . 'uc.facebook, '
        . 'uc.instagram '
        . 'from `user_showcase` us '
        . 'inner join `user_contacts` uc '
        . 'on us.user_id=uc.user_id '
        . $condition);

    if ($sql_get_show_cases && ($sql_get_show_cases->RecordCount() > 0)) {
        $show_case_result = [];
        if ($sql_get_show_cases->Fields('case_name') != null) {
            while (!$sql_get_show_cases->EOF) {

                $sql_get_user_showcase_id = $db->Execute('select id from `user_showcase` where user_id=' . $sql_get_show_cases->Fields('user_id'));
                $showcase_ids = [];
                while (!$sql_get_user_showcase_id->EOF) {
                    $showcase_ids[] = $sql_get_user_showcase_id->Fields('id');
                    $sql_get_user_showcase_id->MoveNext();
                }
                $sql_get_user_rating = $db->Execute('select sum(rating_value) as `sum` from `case_rating` where case_id in (' . implode(',', $showcase_ids) . ')');
                $user_rating = $sql_get_user_rating->Fields('sum');

                if (isset($_GET['id']) && $_GET['id'] != '') {
                    $case_id = intval($_GET['id']);
                } else {
                    $case_id = $sql_get_show_cases->Fields('id');
                }

                $sql_get_show_case_rating = $db->Execute('select sum(rating_value) as `sum` from `case_rating` where case_id=' . $case_id);

                $show_case_result[] = [
                    'id' => $sql_get_show_cases->Fields('id'),
                    'user_id' => $sql_get_show_cases->Fields('user_id'),
                    'adding_time' => FormatDate($sql_get_show_cases->Fields('adding_time')),
                    'adding_time_raw' => $sql_get_show_cases->Fields('adding_time'),
                    'update_time' => FormatDate($sql_get_show_cases->Fields('update_time')),
                    'update_time_raw' => $sql_get_show_cases->Fields('update_time'),
                    'case_name' => $sql_get_show_cases->Fields('case_name'),
                    'photo_url' => ADS_IMAGES_PATH . $sql_get_show_cases->Fields('photo_url'),
                    'price' => $sql_get_show_cases->Fields('price'),
                    'old_price' => $sql_get_show_cases->Fields('old_price'),
                    'type' => $sql_get_show_cases->Fields('type'),
                    'full_type' => $sql_get_show_cases->Fields('full_type'),
                    'detail_type' => $sql_get_show_cases->Fields('detail_type'),
                    'state' => $sql_get_show_cases->Fields('state'),
                    'wheel_size' => $sql_get_show_cases->Fields('wheel_size'),
                    'velo_type' => $sql_get_show_cases->Fields('velo_type'),
                    'direction' => $sql_get_show_cases->Fields('direction'),
                    'description' => $sql_get_show_cases->Fields('description'),
                    'additionalPhotos' => $sql_get_show_cases->Fields('additionalPhotos'),
                    'active' => $sql_get_show_cases->Fields('active'),
                    'case_rating' => $sql_get_show_case_rating->Fields('sum'),
                    'user_rating' => $user_rating,
                    'user_photo' => $sql_get_show_cases->Fields('photo'),
                    'user_name' => $sql_get_show_cases->Fields('name'),
                    'user_surname' => $sql_get_show_cases->Fields('surname'),
                    'user_area' => $sql_get_show_cases->Fields('area'),
                    'user_telegram' => $sql_get_show_cases->Fields('telegram'),
                    'user_phone' => $sql_get_show_cases->Fields('phone'),
                    'user_phone2' => $sql_get_show_cases->Fields('phone2'),
                    'user_vk' => $sql_get_show_cases->Fields('vk'),
                    'user_facebook' => $sql_get_show_cases->Fields('facebook'),
                    'user_instagram' => $sql_get_show_cases->Fields('instagram')
                ];
                $sql_get_show_cases->MoveNext();
            }
        }

        result_text(0, $show_case_result);
    } else {
        result_text(1, 'INTERNAL_ERROR 131');
    }
}

function FormatDate($date)
{
    if ($date >= strtotime("today")) {
        return (object) array('alias' => 'MAIN.TODAY', 'time' => strftime("%H:%M", $date));
    } else if ($date >= strtotime("yesterday")) {
        return (object) array('alias' => 'MAIN.YESTERDAY', 'time' => strftime("%H:%M", $date));
    } else {
        return strftime("%d.%m", $date);
    }
}

function ShowCaseChangeRating()
{
    global $db;

    if (SqlGetUserId()) {

        $case_id = intval($_GET['case_id']);
        $type = intval($_GET['type']);

        // id пользователя изменившего рейтинг
        $cur_user_id = SqlGetUserId();
        // id пользователя этого объявления
        $sql_get_user_id_case = $db->Execute('select user_id from `user_showcase` where id=' . $case_id);
        // id пользователей изменявших когда-либо рейтинг этого объявления
        $sql_get_user_state = $db->Execute('select user_id from `case_rating` where case_id=' . $case_id);

        if ($cur_user_id != $sql_get_user_id_case->Fields('user_id')) {
            if (!$sql_get_user_state->Fields('user_id') || $sql_get_user_state->Fields('user_id') != $cur_user_id) {
                $sql_add_new_rating = $db->Execute('insert into `case_rating` '
                    . '(case_id, user_id, rating_value)'
                    . ' values '
                    . '(' . $case_id . ', ' . $cur_user_id . ', ' . $type . ')');
                if ($sql_add_new_rating) {
                    result_text(2, $type);
                } else {
                    result_text(1, 'INTERNAL_ERROR 141');
                }
            } else {
                $sql_get_user_type = $db->Execute('select rating_value from `case_rating` where case_id=' . $case_id . ' and user_id=' . $cur_user_id);

                if ($sql_get_user_type->Fields('rating_value') != $type) {
                    $sql_set_user_type = $db->Execute('delete from `case_rating` where case_id=' . $case_id . ' and user_id=' . $cur_user_id . ' and rating_value!=' . $type);
                    if ($sql_set_user_type) {
                        result_text(2, $type);
                    } else {
                        result_text(1, 'INTERNAL_ERROR 142');
                    }
                } else {
                    result_text(1, 'REPEATING_CHANGE_RATING');
                }
            }
        } else {
            result_text(0, 'NO_ALLOW_TO_CHANGE_RATING');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 143');
    }
}

function ShowCaseGetRating()
{
    global $db;

    if (isset($_GET['case_id']) && $_GET['case_id'] != '') {
        $case_id = intval($_GET['case_id']);
        $sql_get_case_rating = $db->Execute('select sum(rating_value) as `sum` from `case_rating` where case_id=' . $case_id);
        if ($sql_get_case_rating) {
            result_text(0, $sql_get_case_rating->Fields('sum'));
        } else {
            result_text(1, 'INTERNAL_ERROR 151');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 152');
    }
}

function GetActiveRating()
{
    global $db;

    if (SqlGetUserId()) {
        $sql_get_case_rating_status = $db->Execute('select case_id, rating_value from `case_rating` where user_id=' . SqlGetUserId());

        if ($sql_get_case_rating_status && $sql_get_case_rating_status->Fields('case_id') != null) {
            $case_id_arr = [];
            while (!$sql_get_case_rating_status->EOF) {
                $case_id_arr[] = [
                    'id' => $sql_get_case_rating_status->Fields('case_id'),
                    'value' => $sql_get_case_rating_status->Fields('rating_value')
                ];
                $sql_get_case_rating_status->MoveNext();
            }
            result_text(0, $case_id_arr);
        } else {
            result_text(1, 'NO_FAVORITE_SHOWCASES');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 161');
    }
}

function ShowCaseToggleFavorite()
{
    global $db;

    if (isset($_GET['case_id']) && $_GET['case_id'] != '' && SqlGetUserId()) {
        $case_id = intval($_GET['case_id']);

        $sql_get_case_favorite_status = $db->Execute('select case_id from `case_favorite` where case_id=' . $case_id . ' and user_id=' . SqlGetUserId());

        if ($sql_get_case_favorite_status->Fields('case_id') != null) {
            $sql_delete_favorite_from_case = $db->Execute('delete from `case_favorite` where case_id=' . $case_id . ' and user_id=' . SqlGetUserId());
            if ($sql_delete_favorite_from_case) {
                result_text(0, 'SHOWCASE_REMOVED_FROM_FAVORITES');
            } else {
                result_text(1, 'INTERNAL_ERROR 171');
            }
        } else {
            $sql_set_favorite_to_case = $db->Execute('insert into `case_favorite` (case_id, user_id) values (' . $case_id . ',' . SqlGetUserId() . ')');
            if ($sql_set_favorite_to_case) {
                result_text(0, 'SHOWCASE_ADDED_TO_FAVORITES');
            } else {
                result_text(1, 'INTERNAL_ERROR 172');
            }
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 173');
    }
}

function GetActiveFavorite()
{
    global $db;

    if (SqlGetUserId()) {
        $sql_select_favorite_case_id = $db->Execute('select case_id from `case_favorite` where user_id=' . SqlGetUserId());
        if ($sql_select_favorite_case_id && $sql_select_favorite_case_id->Fields('case_id') != null) {
            $case_id_arr = [];
            while (!$sql_select_favorite_case_id->EOF) {
                $case_id_arr[] = $sql_select_favorite_case_id->Fields('case_id');
                $sql_select_favorite_case_id->MoveNext();
            }
            result_text(0, $case_id_arr);
        } else {
            result_text(1, 'NO_FAVORITE_SHOWCASES');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 181');
    }
}

function IsOwner()
{
    global $db;
    if (isset($_GET['id']) && $_GET['id'] != '') {
        $case_id = $_GET['id'];
        $sql_is_owner = $db->Execute('select case_name from `user_showcase` where user_id=' . SqlGetUserId() . ' and id=' . intval($case_id));
        if ($sql_is_owner && $sql_is_owner->Fields('case_name') != '') {
            echo json_encode(true);
            return true;
        } else {
            echo json_encode(false);
            return false;
        }
    } else {
        echo json_encode(false);
        return false;
    }
}

function GetCase()
{
    global $db;

    if (isset($_GET['id']) && $_GET['id'] != '') {
        $sql_get_show_case = $db->Execute('select `id`, `user_id`, `adding_time`, `case_name`, `photo_url`, `price`, `type`, `full_type`, `detail_type`, `state`, `wheel_size`, `velo_type`, `direction`, `description`, `additionalPhotos` from `user_showcase` where id=' . intval($_GET['id']));

        if ($sql_get_show_case && ($sql_get_show_case->RecordCount() > 0)) {
            if ($sql_get_show_case->Fields('case_name') != null) {
                $show_case_result = [
                    'id' => $sql_get_show_case->Fields('id'),
                    'user_id' => $sql_get_show_case->Fields('user_id'),
                    'adding_time' => FormatDate($sql_get_show_case->Fields('adding_time')),
                    'case_name' => $sql_get_show_case->Fields('case_name'),
                    'photo_url' => ADS_IMAGES_PATH . $sql_get_show_case->Fields('photo_url'),
                    'price' => $sql_get_show_case->Fields('price'),
                    'type' => $sql_get_show_case->Fields('type'),
                    'full_type' => $sql_get_show_case->Fields('full_type'),
                    'detail_type' => $sql_get_show_case->Fields('detail_type'),
                    'state' => $sql_get_show_case->Fields('state'),
                    'wheel_size' => $sql_get_show_case->Fields('wheel_size'),
                    'velo_type' => $sql_get_show_case->Fields('velo_type'),
                    'direction' => $sql_get_show_case->Fields('direction'),
                    'description' => $sql_get_show_case->Fields('description'),
                    'additionalPhotos' => $sql_get_show_case->Fields('additionalPhotos'),
                ];
                result_text(0, $show_case_result);
            } else {
                result_text(1, 'INTERNAL_ERROR 191');
            }
        } else {
            result_text(1, 'INTERNAL_ERROR 192');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 193');
    }
}

function ShowCaseToggleActive()
{
    global $db;

    if (isset($_GET['case_id']) && $_GET['case_id'] != '' && SqlGetUserId()) {
        $case_id = intval($_GET['case_id']);

        $sql_get_case_active_status = $db->Execute('select active from `user_showcase` where id=' . $case_id . ' and user_id=' . SqlGetUserId());

        if ($sql_get_case_active_status->Fields('active') != null) {
            if ($sql_get_case_active_status->Fields('active') == 1) {
                $sql_toggle_case_active_status = $db->Execute('update `user_showcase` set active=0 where id=' . $case_id . ' and user_id=' . SqlGetUserId());
                if ($sql_toggle_case_active_status) {
                    result_text(0, 'SHOWCASE_DEACTIVATED');
                } else {
                    result_text(2, 'INTERNAL_ERROR 201');
                }
            } else if ($sql_get_case_active_status->Fields('active') == 0) {
                $sql_toggle_case_active_status = $db->Execute('update `user_showcase` set active=1 where id=' . $case_id . ' and user_id=' . SqlGetUserId());
                if ($sql_toggle_case_active_status) {
                    result_text(1, 'SHOWCASE_ACTIVATED');
                } else {
                    result_text(2, 'INTERNAL_ERROR 202');
                }
            } else {
                result_text(2, 'INTERNAL_ERROR 203');
            }
        } else {
            result_text(2, 'INTERNAL_ERROR 204');
        }
    } else {
        result_text(2, 'INTERNAL_ERROR 205');
    }
}

function DeleteShowCase()
{
    global $db;

    if (isset($_GET['case_id']) && $_GET['case_id'] != '' && SqlGetUserId()) {
        $case_id = $_GET['case_id'];
        $sql_delete_show_case = $db->Execute('delete from `user_showcase` where id=' . $case_id . ' and user_id=' . SqlGetUserId());
        if ($sql_delete_show_case) {
            result_text(0, 'SHOWCASE_DELETED');
        } else {
            result_text(1, 'INTERNAL_ERROR 210');
        }
    } else {
        result_text(1, 'INTERNAL_ERROR 211');
    }
}
